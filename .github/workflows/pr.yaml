name: Pull Request Pipeline

on:
  pull_request:
    branches:
      - main

jobs:
  playwright-ts-test:
    name: Playwright
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Setup Repo
        uses: ./.github/actions/setup
        with:
          framework-path: './playwright-test'

      - name: Test desktop:chrome
        shell: bash
        working-directory: ./playwright-test
        run: time npm run test:desktop:chrome

  codeceptjs-ts-test:
    name: CodeceptJS + Playwright
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Setup Repo
        uses: ./.github/actions/setup
        with:
          framework-path: './codeceptjs-ts-test'

      - name: Test desktop:chrome
        shell: bash
        working-directory: ./codeceptjs-ts-test
        run: time npm run test:desktop:chrome:workers

      - name: Test A11y in CodeceptJS
        shell: bash
        working-directory: ./codeceptjs-ts-test
        run: time npm run test:a11y:CI
        continue-on-error: true